within SolarTherm.Validation.Models;

model sCO2_Testrig
  package HTF = SolarTherm.Media.SolidParticles.CarboHSP_ph;
  package sCO2 = SolarTherm.Media.CO2.CO2_ph;
  parameter Real gamma = 0.28;
  SolarTherm.Models.PowerBlocks.sCO2Cycle.DirectDesign.recompPB recompPB(redeclare package MedPB = sCO2, redeclare package MedRec = HTF, E_net(displayUnit = ""), N_HTR = 15, N_LTR = 15, N_exch = 5, PR = 2.5, P_gro = 1e8, P_nom = 1e8, T_HTF_in_des = 800 + 273.15, T_amb_des = 43 + 273.15, T_high = 715 + 273.15, T_low = 45 + 273.15, choiceN = {7853.981634, 3141.5926536, 1047.1975512, 376.991118432}, eta_comp_main = 0.89, eta_comp_re = 0.89, eta_turb = 0.93, external_parasities = false, gamma = 0.28, m_HTF_des = 1000, nu_min = 0.5, p_high = 200e5, ratio_m_des = 1 - gamma)  annotation(
    Placement(visible = true, transformation(origin = {62, 28}, extent = {{-42, -42}, {42, 42}}, rotation = 90)));
  Modelica.Blocks.Sources.RealExpression mass_signal(y = 1000) annotation(
    Placement(visible = true, transformation(origin = {13, 15}, extent = {{-9, -9}, {9, 9}}, rotation = 0)));
  SolarTherm.Models.Fluid.Pumps.LiftSimple liftSimple(redeclare package Medium = HTF, use_input = true) annotation(
    Placement(visible = true, transformation(origin = {-27, -7}, extent = {{23, -23}, {-23, 23}}, rotation = 0)));
  Modelica.Blocks.Sources.RealExpression dp annotation(
    Placement(visible = true, transformation(origin = {-20, 51}, extent = {{-14, -13}, {14, 13}}, rotation = 0)));
  Modelica.Fluid.Sources.FixedBoundary source(redeclare package Medium = HTF,T = 800 + 273.15, nPorts = 1, use_p = true)  annotation(
    Placement(visible = true, transformation(origin = {-82, -4}, extent = {{-10, -10}, {10, 10}}, rotation = 0)));
equation
  connect(liftSimple.fluid_b, recompPB.fluid_a) annotation(
    Line(points = {{-18, -4}, {48, -4}, {48, 10}, {48, 10}}, color = {0, 127, 255}));
  connect(dp.y, liftSimple.dp) annotation(
    Line(points = {{-5, 51}, {-2, 51}, {-2, 22}, {-22, 22}, {-22, 10}}, color = {0, 0, 127}));
  connect(mass_signal.y, liftSimple.m_flow) annotation(
    Line(points = {{23, 15}, {-30, 15}, {-30, 10}}, color = {0, 0, 127}));
  connect(source.ports[1], liftSimple.fluid_a) annotation(
    Line(points = {{-72, -4}, {-34, -4}, {-34, -4}, {-34, -4}}, color = {0, 127, 255}));
end sCO2_Testrig;